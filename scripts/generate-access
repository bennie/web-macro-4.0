#!/usr/bin/perl -w

# This script generates the user directories
# (c) 2006, Phillip Pollard <bennie@macrophile.com>

use strict;

### Conf

my $debug = 0; # Debug output
my $file = '/var/www/macrophile.com/share/htaccess';

### Spam IPs

my %spams = map { $_,1 } 
  qw/12.215.212.252 202.101.6.85 203.113.13.4 207.210.117.113 207.234.225.206
     213.255.96.227 216.32.72.74 219.136.249.79 61.185.219.235 67.18.109.66
     69.31.86.60 80.134.12.128 80.58.205.37 80.58.205.43 80.58.205.47
     84.252.155.120 200.206.17.60 66.98.212.79 75.22.219.72 200.63.213.2
     221.214.6.188 83.149.74.151 196.209.251.3 221.149.121.138/;

my %crawls = map { $_,1 } 
  qw/209.33.213.2/;

my %abuse = map { $_, 1 }
  qw/209.7.107.42/; # crawling?

$abuse{'82.46.203.117'} = 1; # tinybr banned for spam/abuse

map { $abuse{$_} = 1 }
  qw/68.52.248.132 98.193.173.28 68.52.148.133 216.77.124.137/; # * banned - troll

map { $abuse{$_} = 1 }
  qw/77.105.55.250 79.175.65.200 77.105.55.236 77.105.57.4 77.105.55.35 
     77.105.27.67 77.105.60.180 77.105.46.130 77.105.61.158/; # nikos - troll

=head3 stop AOL stop

map { $abuse{$_} = 1 }
  qw/205.188.116.65 152.163.100.195 152.163.100.132 152.163.101.13 205.188.117.69 
     205.188.116.139 152.163.100.11 205.188.117.74 152.163.100.139 205.188.117.66
     152.163.100.130 205.188.116.70 152.163.100.10 152.163.100.133 152.163.100.5
     152.163.100.67 64.53.202.25/; # Piro-San
     
map { $abuse{$_} = 1 }
  qw/152.163.100.195 205.188.116.65 205.188.117.10 205.188.116.11 205.188.117.66
     205.188.116.74 205.188.116.204 205.188.116.131 205.188.116.196
     205.188.117.7/; # Wolfy Boy

map { $abuse{$_} = 1 }
  qw/152.163.100.6 152.163.100.195 64.12.116.195 205.188.116.65 205.188.116.70 64.12.116.196
     152.163.100.12 64.12.116.138 64.12.116.68 152.163.100.10 205.188.116.137 64.12.116.137
     64.12.117.13 64.12.117.9 205.188.116.73 64.12.116.131 152.163.100.65 205.188.116.200
     64.12.116.11 152.163.100.72 205.188.116.10 64.12.116.135 205.188.117.74 64.12.116.10
     152.163.100.7 205.188.116.74 64.12.116.67 152.163.100.203 205.188.117.12 64.12.117.7
     152.163.101.12  205.188.116.131 64.12.116.7 152.163.100.71 205.188.116.138 64.12.117.10
     152.163.100.67 64.12.116.5/; # Fullmetal Wolf

map { $abuse{$_} = 1 }
  qw/209.7.107.42 64.12.116.195 205.188.116.65 64.12.116.135 64.12.116.67
     64.12.116.14 64.12.117.14 205.188.116.8 64.12.116.132 205.188.117.5
     64.12.117.9 64.12.117.11 64.12.116.137 205.188.116.66 152.163.100.13
     205.188.116.132 205.188.117.70 64.12.116.201 64.12.116.199 64.12.116.9
     64.12.116.134/; # Anam Cara

map { $abuse{$_} = 1 }
  qw/152.163.100.11 152.163.100.195 64.12.116.195 209.7.107.42 205.188.116.65 
     205.188.116.67 152.163.100.5 152.163.98.184 152.163.101.6 64.12.116.14 
     64.12.116.70 64.12.116.134 152.163.100.203 64.12.116.138 152.163.101.9 
     64.12.117.5 205.188.116.200 152.163.101.13 64.12.117.9 152.163.100.13 
     205.188.117.9/; # Gano Viker

=cut

my $me = '66.167.9.73';

### Do it

print "Writing $file\n";

open OUTFILE, '>', $file;
print OUTFILE "order deny,allow\n";

print OUTFILE "deny from $me\n" if $debug;

for my $spammer ( sort keys %spams ) {
  print OUTFILE "deny from $spammer\n";
}

for my $crawler ( sort keys %crawls ) {
  print OUTFILE "deny from $crawler\n";
}

for my $abuser ( sort keys %abuse ) {
  print OUTFILE "deny from $abuser\n";
}

print OUTFILE "ErrorDocument 403 http://error.macrophile.com/403.cgi\n";

close OUTFILE;
